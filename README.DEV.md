# Developer Quickstart (Windows PowerShell)

Use this guide to run the core developer flows on Windows: start the mock backend, execute the `ai-ide` unit tests, exercise the Playwright smoke suite, and capture diagnostics so CI parity stays high.

## Prerequisites
- Node.js (recommended LTS)
- npm
- Windows PowerShell (the commands below assume the default shell)

## Install dependencies
Run once after cloning to keep the repo root and the LLM mock server in sync:

```powershell
npm install
Push-Location tools/llm-mock
npm install
Pop-Location
```

The Playwright tests depend on `tools/llm-mock`, so forgetting the second `npm install` will break the MCP/tooling flows.

## Start the developer mock backend (127.0.0.1:8010)

```powershell
npm run dev:mock-backend
```

Leave this terminal open while running Playwright or any flows that rely on mocked providers.

## Run ai-ide unit tests (mocha)

```powershell
npm run test:ai-ide

Push-Location cloud-ide-desktop/aethel_theia_fork/packages/ai-ide
node ./test/run-mocha.js
Pop-Location
```

The top-level script handles compilation for you; the manual runner is helpful when you need to debug inside the package.

## Run Playwright smoke E2E tests

```powershell
npm run playwright:install
npm run test:e2e
npm run test:e2e:headed
```

- Always start the mock backend first (see above) so the tests can hit `127.0.0.1:8010`.
- Use the headed variant when you need to observe UI regressions in real time.

## Generate Playwright diagnostics summary
After a Playwright run, consolidate results into `diagnostics/PLAYWRIGHT_SUMMARY.txt` so CI and reviewers see the same data:

```powershell
npm run diagnostics:playwright
```

This command invokes `tools/ci/write-playwright-summary.mjs` to read `test-results/playwright.json` and emit a human-readable summary; attach the text file to PRs when browser flakes occur.
 
GitHub Actions (`ci-playwright.yml`) now runs the same summary generation step automatically and uploads `PLAYWRIGHT_SUMMARY.txt` for every browser run, so local and remote diagnostics stay in sync.
GitHub Actions (`ci-playwright.yml`) now runs the same summary generation step automatically and uploads `PLAYWRIGHT_SUMMARY.txt` for every browser run, so local and remote diagnostics stay in sync.

## TypeScript checks

```powershell
npx -y tsc --noEmit -p .\cloud-web-app\web\tsconfig.json
npx -y tsc --noEmit -p .\cloud-ide-desktop\aethel_theia_fork\packages\ai-ide\tsconfig.json
npm run ci:local
```

`npm run ci:local` approximates the GitHub Actions pipeline by chaining TypeScript, mocha, and Playwright steps.

## Repo syntax check

```powershell
powershell -ExecutionPolicy Bypass -File build/check_syntax.ps1
```

## Notes & Troubleshooting
- If Playwright reports `ECONNREFUSED ::1:8010`, set `NEXT_PUBLIC_API_URL` to `http://127.0.0.1:8010` or ensure Windows is not routing to IPv6.
- When port 8010 is occupied, either stop the other process or change the mock backend port in `tools/dev-mock-backend/server.js`.
- The legacy `apiClient` wrapper in `cloud-web-app/web/lib/api-client.ts` still proxies to the canonical client, so incremental migrations are safe.

## CI overview
- `.github/workflows/ci.yml` runs Windows + Ubuntu lint/tests on push/PR and includes an optional `workflow_dispatch` input for Playwright E2E.
- `.github/workflows/ci-playwright.yml` is the dedicated browser pipeline; wire `npm run diagnostics:playwright` artifacts into its uploads for parity with local runs.

Use the `workflow_dispatch` entry points when you need to validate browsers or diagnostics on demand.

## Related docs
- `docs/ai-ide-quality-status.md` — live status checklist for the IDE surface and CI coverage.
- `docs/ai-ide-best-in-market-plan.md` — roadmap describing how we surpass VS Code/Unreal/Copilot.

---
Generated by automation on request. If anything is missing or you want me to push a branch with these infra/docs changes, tell me to proceed and I will create a feature branch and run CI on GitHub (if you want that step automated).
