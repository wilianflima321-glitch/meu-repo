# Developer Quickstart (Windows PowerShell)

This file explains the common developer flows for the repo on Windows (PowerShell).
It's focused on what we've been doing: running the `ai-ide` unit tests under Node (no browser), starting the lightweight developer mock backend, and running Playwright E2E smoke tests.

Prerequisites
- Node.js (recommended LTS)
- npm
- PowerShell (Windows default)

Start the developer mock backend (runs on 127.0.0.1:8010)

```powershell
# from repo root (run in a terminal you can leave open)
npm run dev:mock-backend
# If you need to stop: Ctrl+C or close the terminal.
```

Run ai-ide unit tests (sequential runner uses compiled JS in the Theia fork):

```powershell
# change to the theia fork package
Push-Location cloud-ide-desktop/aethel_theia_fork/packages/ai-ide;
# Developer Quickstart (Windows PowerShell)

This file explains the common developer flows for the repo on Windows (PowerShell).
It's focused on running the `ai-ide` unit tests under Node (no browser), starting the lightweight developer mock backend, and running Playwright E2E smoke tests.

Prerequisites
- Node.js (recommended LTS)
- npm
- PowerShell (Windows default)

Start the developer mock backend (runs on 127.0.0.1:8010)

```powershell
# from repo root
npm run dev:mock-backend;
# If you need to stop: find the process and stop it, or close the terminal.
```

Run ai-ide unit tests (sequential runner uses compiled JS in the Theia fork):

```powershell
# from repo root (recommended)
npm run test:ai-ide

# or, change directory to the package and run the programmatic mocha runner:
Push-Location cloud-ide-desktop/aethel_theia_fork/packages/ai-ide
node ./test/run-mocha.js
Pop-Location
```

Run Playwright smoke E2E tests (targets mock backend by default)

```powershell
# one-time: install playwright browsers (Linux/Windows/Mac with dependencies)
npm run playwright:install

# run tests (headless by default)
npm run test:e2e

# run headed if you want to watch the browsers
npm run test:e2e:headed
```

TypeScript checks

```powershell
# check the web package
npx -y tsc --noEmit -p .\cloud-web-app\web\tsconfig.json

# check the Theia ai-ide package
npx -y tsc --noEmit -p .\cloud-ide-desktop\aethel_theia_fork\packages\ai-ide\tsconfig.json

# quick local run that approximates CI (runs TS check, ai-ide tests, and Playwright E2E)
npm run ci:local
```

Repo syntax check (existing helper)

```powershell
# runs various syntax checks across the repo
powershell -ExecutionPolicy Bypass -File build/check_syntax.ps1
```

Notes & Troubleshooting
- If Playwright fails with ECONNREFUSED to ::1:8010, set NEXT_PUBLIC_API_URL or ensure the mock backend is bound to 127.0.0.1 (our dev mock binds IPv4 by default). On Windows sometimes ::1 (IPv6) causes mismatched bindings.
- If port 8010 is in use: either stop the other service or change the mock backend port (tools/dev-mock-backend/server.js).
- For migrating code using the legacy `apiClient` instance: the compatibility wrapper `cloud-web-app/web/lib/api-client.ts` delegates to the canonical `cloud-web-app/web/lib/api.ts` client so both styles are supported.

Further work to consider
- Expand Playwright E2E to cover full web UI chat flows and add that to CI as an optional job.
- Create a POC Theia extension that proxies AI provider calls through the backend and validate with the mock backend.

CI
--
We provide a lightweight GitHub Actions workflow at `.github/workflows/ci.yml` that runs on pushes/PRs to `main`:

- `build` job (runs on Windows): checks repo syntax (`build/check_syntax.ps1`), runs a TypeScript check, and executes the `ai-ide` unit tests.
- `e2e` job (manual `workflow_dispatch`): installs Playwright browsers and runs the Playwright smoke tests. Trigger it manually to avoid running browser tests on every push.

Use the `workflow_dispatch` button in GitHub Actions to run the E2E job when you want to validate browsers.

---
Generated by automation on request. If anything is missing or you want me to push a branch with these infra/docs changes, tell me to proceed and I will create a feature branch and run CI on GitHub (if you want that step automated).
